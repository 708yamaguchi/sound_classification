<launch>
  <arg name="microphone_name" default="default"/> <!-- default microphone on thinkpad T460s -->
  <arg name="length" default="512"/> <!-- the number of sampling data in fft -->
  <arg name="rate" default="44100"/> <!-- sampling rate of microphone -->
  <arg name="cutoff_rate" default="8000"/> <!-- cutoff the high frequency data from fft result -->
  <arg name="hit_volume_threshold" default="0.01"/> <!-- volume threshold to detect sound -->
  <arg name="time_to_listen" default="0.3"/> <!-- total time of horizontal axis of spectrogram -->
  <arg name="target_class" default="table"/> <!-- target class of saved spectrogram -->
  <arg name="classification" default="true"/> <!-- online sound classification on ROS -->
  <arg name="rqt" default="true"/> <!-- visualize spectrogram, object class and camera image on rqt -->

  <!-- frequency resolution of fft: $(arg rate) / $(arg length) -->
  <param name="/microphone/name" value="$(arg microphone_name)"/>
  <param name="/microphone/length" value="$(arg length)"/>
  <param name="/microphone/rate" value="$(arg rate)"/>

  <!-- publish sound topics from microphone -->
  <node pkg="sound_classification" type="listen_microphone.py" name="listen_microphone" output="screen" respawn="true" >
    <param name="cutoff_rate" value="$(arg cutoff_rate)"/>
    <param name="hit_volume_threshold" value="$(arg hit_volume_threshold)"/>
    <param name="time_to_listen" value="$(arg time_to_listen)"/>
  </node>

  <!-- sound classification -->
  <group if="$(arg classification)">
      <node pkg="sound_classification" type="classify_spectrogram_ros.py" name="classify_spectrogram_ros" output="screen">
        <param name="model" value="$(find sound_classification)/scripts/result/model_best.npz"/>
      </node>
  </group>
  <!-- visualization of sound classification in rqt -->
  <group if="$(arg rqt)">
    <node pkg="rqt_gui" type="rqt_gui" name="rqt_gui" args="--perspective-file $(find sound_classification)/config/spectrogram_classification.perspective"/>
    <node pkg="usb_cam" type="usb_cam_node" name="usb_cam_node" />
  </group>

</launch>
